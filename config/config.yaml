# Trudy Telegram Note-Taking System Configuration

telegram:
  bot_token: "${TELEGRAM_BOT_TOKEN}"  # Set in .env file
  api_url: "https://api.telegram.org"
  timeout: 30
  retry_attempts: 3

# User Discovery Configuration
# Trudy 2.0 uses AUTO-DISCOVERY ONLY
# Users are automatically discovered when they send messages to your bot.
# Usernames are generated from their Telegram username or name.
users: []

storage:
  base_dir: "./data"
  staging_dir: "staging"
  processed_dir: "processed"
  media_dir: "media"

  # Staging retention policy
  staging_retention:
    policy: "keep_days"  # Options: keep_all, keep_days, delete_after_process
    days: 7  # Used when policy is "keep_days"

transcription:
  enabled: true
  provider: "ollama"  # Options: ollama, remote
  ollama:
    base_url: "http://localhost:11434"
    model: "whisper"
    timeout: 300
  youtube_prefer_transcript: true  # Try YouTube transcript API before downloading

summarization:
  enabled: true
  provider: "ollama"  # Options: ollama, claude
  ollama:
    base_url: "http://localhost:11434"
    model: "llama2"  # Options: llama2, mistral, phi, etc.
    temperature: 0.7
    max_tokens: 500
  claude:
    cli_path: "claude"  # Path to Claude Code CLI executable
    model: "claude-sonnet-4-5"
    max_tokens: 1000
  prompts:
    video_summary: "Summarize the key points from this video transcript in 3-5 bullet points."
    audio_summary: "Summarize the main topics discussed in this audio recording."
    article_summary: "Provide a concise summary of this article in 2-3 paragraphs."
    youtube_summary: "Summarize this YouTube video, highlighting key takeaways."

# OCR Configuration
ocr:
  enabled: true
  provider: "tesseract"  # Options: tesseract, cloud

  tesseract:
    languages: ["eng"]  # OCR languages
    config: "--psm 3"  # Page segmentation mode

  cloud:
    provider: "google_vision"  # Options: google_vision, azure, aws
    api_key: "${OCR_API_KEY}"  # Set in .env file if using cloud OCR

# Link Extraction Configuration
links:
  enabled: true
  timeout: 10  # seconds
  user_agent: "Trudy/2.0 (Personal Knowledge Bot)"
  extract:
    title: true
    description: true
    opengraph: false  # Disabled per user preference
    favicon: false    # Disabled per user preference

# Auto-Tagging Configuration
tagging:
  enabled: true

  # Rule-based tags (fast, deterministic)
  rules:
    - pattern: "screenshot"
      tag: "#screenshot"
    - pattern: "meeting"
      tag: "#meeting"
    - pattern: "reminder|remind"
      tag: "#reminder"
    - pattern: "todo|task"
      tag: "#task"
    - pattern: "\\.pdf$"
      tag: "#document"
    - pattern: "youtube\\.com|youtu\\.be"
      tag: "#youtube"
    - pattern: "image|photo"
      tag: "#image"
    - pattern: "video"
      tag: "#video"
    - pattern: "audio|voice"
      tag: "#audio"

  # AI-based tagging (optional, slower)
  ai_tagging:
    enabled: false  # Disabled by default
    provider: "ollama"
    model: "llama2"
    max_tags: 5
    prompt: "Generate 3-5 relevant hashtags for this message. Return only hashtags separated by commas."

processing:
  max_workers: 3  # Number of parallel processing workers
  skip_errors: true  # Continue processing if individual messages fail
  retry_failed: true  # Retry failed messages
  max_retries: 3

  # Progress reporting
  show_progress: true
  report_interval: 10  # Update progress every N messages

logging:
  level: "INFO"  # Options: DEBUG, INFO, WARNING, ERROR
  file: "./logs/trudy.log"
  error_file: "./logs/errors.log"
  max_bytes: 10485760  # 10MB
  backup_count: 5

markdown:
  timezone: "America/New_York"  # Local timezone for timestamps
  timestamp_format: "HH:mm"  # 24-hour format (lowercase 'mm' for minutes)
  date_format: "YYYY-MM-DD"

  # Wikilink style for media references
  wikilink_style: "obsidian"  # Options: obsidian, markdown

  # Include additional metadata in processed format
  include_message_id: false  # Include Telegram message ID in markdown
  include_edit_history: true  # Track message edits
